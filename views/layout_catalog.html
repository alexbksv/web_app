    {{include 'header.html'}}
    <script type="text/javascript">
        var map;
        function initMap() {

          map = new google.maps.Map(document.getElementById('map_catalog_container'), {
            center: {lat: -30.0196384, lng: -51.1777252},
            zoom: 13,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            mapTypeControl: false,
            scaleControl: false,
            scrollwheel: false,
          });

          var infoWindow = new google.maps.InfoWindow;

          // get all locations of the item
          //TODO: change to get only the region location itens
          downloadUrl("{{=URL(c='geolocation', f='get_item_location.xml', vars={'item':request.args(0)} or 0, scheme=True, host=True)}}", function(data) {
            var xml = data.responseXML;
            var markers = xml.documentElement.getElementsByTagName("marker");
            for (var i = 0; i < markers.length; i++) {
              var name = markers[i].getAttribute("name");
              var popular_name = markers[i].getAttribute("popular_name");
              var address = markers[i].getAttribute("address");
              var comment = markers[i].getAttribute("comment");
              var photo = markers[i].getAttribute("photo");
              var point = new google.maps.LatLng(
                  parseFloat(markers[i].getAttribute("lat")),
                  parseFloat(markers[i].getAttribute("lng")));
              var html = "<div class='col-md-12'> \
                          <div class='col-md-4'> \
                          <img width='150' src='"+photo+"'> \
                          </div> \
                          <div class='col-md-8'> \
                          <strong>" + name + " \
                          </strong> <br/><strong><i>"+popular_name+" \
                          </i></strong><br><i>" + address+"\
                          </i><br>"+comment+" \
                          </div> \
                          </div>";
              var marker = new google.maps.Marker({
                map: map,
                position: point,
                icon: "{{=URL('static', 'images/map_icon.png', scheme=True, host=True)}}"
              });
              bindInfoWindow(marker, map, infoWindow, html);
            }
          });

          // Try HTML5 geolocation.
          if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function(position) {
              var pos = {
                lat: position.coords.latitude,
                lng: position.coords.longitude
              };
              map.setCenter(pos);
            });
          } else {
            // Browser doesn't support Geolocation
            handleLocationError(false, map.getCenter());
            alert("{{=T('Error: Your browser doesn\'t support geolocation.')}}");
          }
        }
        google.maps.event.addDomListener(window, 'load', initMap);

    </script>

    <!-- map catalog -->
    <div class="map-catalog">
        <div id="map_catalog_container"></div>
        <div class="form-map form-inline">
            <form>
                <input type="text" placeholder="{{=T('Type a location, like: New York, NY')}}" class="form-control address" id="search_location">
                <button class="btn btn-default find" type="button">{{=T("Go")}}</button>
                <div class="hidden">
                    <input name="lat" type="text" id="find_lat">
                    <input name="lng" type="text" id="find_lng">
                </div>
            </form>
        </div>
        <div class="btn-map-catalog">
            <a href="{{=URL(c='catalog', f='add_location', args=request.args(0))}}" class="btn btn-info btn-map">{{=T('Add a plant location')}}</a>
        </div>
    </div>
    <!-- /.map -->



    <div class="container">
      {{include}}

    {{include 'footer.html'}}
